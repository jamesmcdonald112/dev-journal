# **README — Info Pack Email Setup (Per Client)**

  

This project sends **internal notification emails** when a user submits the Info Pack form.

  

Email delivery is handled by **Resend** via the deliverInfoPack service.

---

## **Required Environment Variables**

  

You **must** set these for each client/project.

  

### **1)** 

### **RESEND_API_KEY**

### **(required)**

  

Resend API key with sending permissions.

- **Local:** .env.local
    
- **Vercel:** Project → Settings → Environment Variables
    

```
RESEND_API_KEY=re_xxxxxxxxx
```

---

### **2)** 

### **INFO_PACK_TO_EMAIL**

### **(required)**

  

Where form submissions are sent (the business / firm inbox).

  

Supports **comma-separated lists**.

```
INFO_PACK_TO_EMAIL=info@client.ie,leads@client.ie
```

This is **not** the user’s email.

---

### **3)** 

### **INFO_PACK_FROM**

### **(recommended)**

  

The sender identity shown in the email.

  

Must use a **domain verified in Resend**.

```
INFO_PACK_FROM=Client Name <info@client.ie>
```

If not set, a default fallback is used (not recommended for production).

---

### **4)** 

### **INFO_PACK_REPLY_TO**

### **(recommended fallback)**

  

Used **only if** the user’s email is missing.

```
INFO_PACK_REPLY_TO=info@client.ie
```

Normally, replies go directly to the **lead’s email** (the form submitter).

---

## **Email Behaviour (Important)**

- **To:** business / firm inbox (INFO_PACK_TO_EMAIL)
    
- **Reply-To:** user’s email (fallback → INFO_PACK_REPLY_TO)
    
- **Subject:** Info Pack Request — <Name>
    
- **Body:** escaped HTML (safe from script injection)
    

  

This ensures:

- The firm receives the lead
    
- Clicking “Reply” responds to the client, not the website inbox
    
- No untrusted HTML enters emails
    

---

## **Security Notes**

- All user input is HTML-escaped before rendering
    
- Newlines are stripped from the subject (header-injection protection)
    
- Environment misconfiguration fails fast (email is **not** sent)
    

---

## **When copying this project for a new client**

  

You **only change environment variables**.

  

**No code changes required.**

  

Checklist:

- Verify client domain in Resend
    
- Set INFO_PACK_TO_EMAIL
    
- Set INFO_PACK_FROM
    
- (Optional) Set INFO_PACK_REPLY_TO
    

---

# **Tests — Do I need to change anything per client?**

  

**No. You do not touch the tests.**

  

### **Why**

- Tests **mock Resend**
    
- Tests inject **fake env values**
    
- Tests verify behaviour, not client data
    

  

The tests prove:

- Emails are sent correctly
    
- User input is escaped
    
- Missing env vars throw errors
    
- Reply-to logic works
    
- Subject injection is blocked
    

  

These behaviours are **identical for every client**.

  

### **When would tests change?**

  

Only if you:

- Change email behaviour (e.g. add auto-reply)
    
- Add attachments
    
- Switch email provider
    
- Introduce templates
    

  

Not for new clients.

---

## **Final verdict**

  

✔ Email service is **production-ready**

✔ Secure by default

✔ Client-agnostic

✔ No per-client test changes

✔ Safe to reuse for solicitors, music schools, etc.