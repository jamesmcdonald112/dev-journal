DOCS - https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html

## **OWASP REST Security — notes for our Astro API route**

- **Use HTTPS only** for any endpoint that handles sensitive actions (form submissions, email sending).
    
- **Access control on every endpoint**: non-public endpoints must check authorization _at the endpoint_ (don’t rely on “security through obscurity”).
    
- **API keys**:
    
    - Require an API key for protected endpoints.
        
    - **Do not put API keys in the URL** (query params get logged/leaked). Put them in **request headers**.
        
    - Don’t rely on API keys alone for truly sensitive/high-value resources.
        
    
- **Restrict HTTP methods**: allowlist only what you need (e.g. POST), reject others (405).
    
- **Validate content types**:
    
    - Reject missing/unexpected Content-Type (use 415/406 where appropriate).
        
    - Don’t reflect Accept back blindly.
        
    
- **Input validation**: validate length/range/format; reject unexpected/illegal content; set request size limits (413).
    
- **Error handling**: return generic errors; don’t leak stack traces/details.
    
- **Rate limiting**: if abused, return 429 Too Many Requests.
    
- **Use proper HTTP status codes**: 200/201, 400, 401, 403, 405, 415, 429, 500.
    

  

### **How this maps to our app**

- Our /api/test-email endpoint should be protected by a **header token** (simple shared secret) and should return:
    
    - 401/403 when token missing/wrong
        
    - 405 when method is not POST
        
    - 415 when Content-Type isn’t what we expect (if we require JSON)
        
    - 429 if we add rate limiting later
        
    

